## 割り込みハンドラを登録する

- 割り込みベクタ
    - 割り込みの種類ごとに割り当てる番号
    - 例えばゼロ除算に対しては 0 が予約されている
- IDT (Interrupt Descriptor Table)
    - 割り込みベクタからハンドラを引くためのテーブル
    - テーブルの各エントリを割り込み記述子と言う
- IDT をメモリ上の適当な位置に作成し、そこへのポインタを CPU に渡すと登録が完了する
    - x86_64 では lidt 命令を asm で直書きすることになる

## 割り込みを発生させる

- MSI (Message Signaled Interruputs)
    - PCI 規格のもとで定められた割り込み方式
    - (割り込み信号線などを使わずに) 特定のメモリアドレスへの書き込みにより割り込みを表現する
- 「特定のメモリアドレス」とは具体的には:
    - Message Address レジスタ
        - どこに割り込みを発生させるかを記述する
        - Destination ID
            - どの CPU コアに対して割り込みを発生させるか
    - Message Data レジスタ
        - 割り込みの内容 (特に割り込みベクタ) を記述する
- PCI 規格のもとで定められた方法で、PCI デバイス (例えば USB マウス) に対して、どの割り込みベクタを使って割り込みを発生させてほしいかを依頼する
